#!/usr/bin/env bash

CIS_X_HOME=$(realpath $(dirname $0)/../../..)
CIS_X_CORE_HOME=$(realpath $(dirname $0)/..)

SAMPLE_ID=$1
ASE_RESULT_GENE=$2
OHE_RESULT=$3
CANDIDATES_RESULT=$4
THRESH_FPKM=$5
ASE_RESULT_RUN=$6
CANDIDATES_RESULT_RUN=$7

THRESH_AI_DI=0.3
THRESH_AI_CNV=0.2
THRESH_PVALUE_ASE=0.05
THRESH_PVALUE_LOO=0.05
#THRESH_FPKM=5
THRESH_LOO_Hi_Perc=0.1
NUM_MARKERS=4

IMPRINTING_GENES=$CIS_X_HOME/refs/external/ImprintGenes.txt
ONCOGENES=$CIS_X_HOME/refs/external/cancer_gene_census.txt

perl $CIS_X_CORE_HOME/src/ase.candidate.pl \
    $THRESH_PVALUE_ASE \
    $THRESH_AI_DI \
    $THRESH_AI_CNV \
    $THRESH_FPKM \
    $THRESH_PVALUE_LOO \
    $SAMPLE_ID \
    $CANDIDATES_RESULT \
    $ASE_RESULT_GENE \
    $OHE_RESULT \
    $THRESH_LOO_Hi_Perc \
    $IMPRINTING_GENES \
    $ONCOGENES

perl $CIS_X_CORE_HOME/src/ase.candidate.byrun.pl \
    $SAMPLE_ID \
    $THRESH_FPKM \
    $THRESH_PVALUE_LOO \
    $ASE_RESULT_RUN \
    $OHE_RESULT \
    $CANDIDATES_RESULT_RUN \
    $IMPRINTING_GENES \
    $ONCOGENES \
    $NUM_MARKERS \
    $ASE_RESULT_GENE \
    $THRESH_AI_DI \
    $THRESH_AI_CNV 
